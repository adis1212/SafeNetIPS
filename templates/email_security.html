{% extends "base.html" %}
{% block content %}
<h2>Email Security</h2>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }}">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

<h3>Email Log</h3>
<table>
    <tr>
        <th>Type</th>
        <th>Sender</th>
        <th>Recipient</th>
        <th>Subject</th>
        <th>Status</th>
        <th>Time</th>
        <th>Message</th>
    </tr>
    {% for log in logs %}
        <tr>
            <td>{{ log.type }}</td>
            <td>{{ log.sender }}</td>
            <td>{{ log.recipient }}</td>
            <td>{{ log.subject }}</td>
            <td>
                {% if log.status == 'Blocked' %}
                    <span style="color: #ff5555; font-weight: bold;">Blocked</span>
                {% else %}
                    <span style="color: #50fa7b;">Allowed</span>
                {% endif %}
            </td>
            <td>{{ log.time }}</td>
            <td>{{ log.msg }}</td>
        </tr>
    {% endfor %}
</table>
{% endblock %}
